/**------------- 17K小说网 阅读改变人生 ----------------
 -
 -      _~~````````````~_    _~````````````~~_
 -    -/                 \  /                 \-
 -   //                   ||                   \\
 -  //__~====````====~__  || __~====````====~___\\
 - /_==~~~***````***~~--__||__--~~***````***~~~==_\
 -
 * @author ZhangYongfeng
 * @date 2018-8-21
 * @license ChineseAll.com
 * @fileOverview 全局类库和业务, 支持ie8+
 * @class QD
 * @alias k
 */
!function(config){"use strict";function isUn(e){return e===undefined}function isNull(e){return null===e}function empty(e){switch(getType(e)){case _.a.c:if(0===e.length)return!0;break;case _.a.q:var t=null;for(t in e);return isNull(t)}return!e}function isObj(e){return getType(e)===_.a.q}function forObj(e,t,n){if(isObj(e))for(var r in e)if(e.hasOwnProperty(r)&&t.call(n,e[r],r))break}function forArr(e,t,n){for(var r=0;r<e.length&&!t.call(n,e[r],r);r++);}function mapObj(e,t){var n,r={};for(var o in e)e.hasOwnProperty(o)&&(n=t(e[o],o),isUn(n)||(r[o]=n));return r}function mapArr(e,t){for(var n,r=[],o=0;o<e.length;o++)n=t(e[o],o),isUn(n)||r.push(n);return r}function loadCss(e,t){var n=_.A("link");n.rel="stylesheet",n.href=e,n.onload=function(){t&&t()},_.B.appendChild(n)}function loadJs(e,t){var n=_.z(e);if(getType(t)===_.a.m)return void t.appendChild(n);getType(t)===_.a.d?(n.id=t,n.className=t):n.onload=function(){t&&t()},_.B.appendChild(n)}function objMerge(e,t,n){if(isObj(t))for(var r in e)if(e.hasOwnProperty(r)&&t.hasOwnProperty(r)){if(n&&getType(e[r])!==getType(t[r]))break;e[r]=t[r]}return e}function objComb(e,t,n){if(isObj(e)){if(isObj(t))for(var r in t)t.hasOwnProperty(r)&&(n&&isObj(e[r])&&isObj(t[r])?objComb(e[r],t[r],n):e[r]=t[r]);return e}return isObj(t)?t:{}}function parseUrl(e,t){e=e||location.href,0===e.indexOf("//")?e=location.protocol+e:0===e.indexOf("/")?e="//"+location.host+e:e.match(/[a-z]+:\/\//i)||(e="//"+location.host+location.pathname+"/"+e);var n={protocol:function(e){return e?e[0]:location.protocol}(e.match(/^[a-z]+:(?=\/\/)/i)),hostname:function(e){return e?e[1]:location.hostname}(e.match(/\/\/([^\/:]+)/)),port:function(e){return e?e[1]:location.port}(e.match(/:(\d+)(\/|$)/)),hash:function(e){return e?e[0]:location.hash}(e.match(/#.+/)),pathname:function(e){return e.replace(/\?.*/,"").replace(/#.*/,"")||"/"}(e.replace(/^\w+:/,"").replace(/\/\/[^\/]+/,"")),searchObj:function(e){var n=t||{};return e&&(e=e[1].split(/&+/),forArr(e,function(e){e=e.replace("=",_.a.b).split(_.a.b),2===e.length&&(isUn(n[e[0]])?n[e[0]]=e[1]:getType(n[e[0]])===_.a.c?n[e[0]].push(e[1]):n[e[0]]=[n[e[0]],e[1]])})),n}(e.match(/\?([^#]*)/)),searchParams:{getAll:function(e){return getType(n.searchObj[e])===_.a.c?n.searchObj[e]:[n.searchObj[e]]},get:function(e){return getType(n.searchObj[e])===_.a.c?n.searchObj[e][0]:n.searchObj[e]},has:function(e){return!isUn(n.searchObj[e])},set:function(e,t){return n.searchObj[e]=t,n.href},append:function(e,t){return n.searchObj[e]?(getType(n.searchObj[e])!==_.a.c&&(n.searchObj[e]=[n.searchObj[e]]),getType(t)!==_.a.c&&(t=[String(t)]),n.searchObj[e]=n.searchObj[e].concat(t)):n.searchObj[e]=t,n.href},"delete":function(e){return delete n.searchObj[e],n.href},concat:function(e){return forObj(e,function(e,t){this.append(t,e)},this),n.href},toString:function(){var e=[];return forObj(n.searchObj,function(t,n){getType(t)===_.a.c?forArr(t,function(t){""!==t&&e.push(n+"="+t)}):""!==t&&e.push(n+"="+t)}),e.join("&")}}};if(_.F){var r=_.A("span");forObj(n,function(e,t){_.G(r,t,{value:e})}),n=r}return _.G(n,"href",{get:function(){return n.protocol+"//"+n.host+n.pathname+n.search+n.hash}}),_.G(n,"search",{get:function(){var e=n.searchParams.toString();return e?"?"+e:""}}),_.G(n,"host",{get:function(){return n.hostname+(n.port?":"+n.port:"")}}),n}function getType(e){if(typeof e!==_.a.q)return typeof e===_.a.o&&isNaN(e)?"nan":typeof e;if(null===e)return"null";if(typeof e.nodeType!==_.a.o)return e.window?_.a.u:e.item&&e.length?_.a.p:Object.prototype.toString.call(e).slice(8,-1).toLowerCase();switch(e.nodeType){case 9:return _.a.j;case 3:return _.a.t;case 8:return _.a.h;default:return _.a.m}}function xhr(e){e=objMerge({header:{},data:{},url:"./",method:_.a.l,async:!0,success:_.x,failed:_.x,type:""},e,!0),e.url=parseUrl(e.url);var t,n=function(t){return e.type.toLowerCase()===_.a.n&&(t=parseJson(t)),t};e.url.host!==location.host&&_.u.XDomainRequest?(t=new XDomainRequest,t.onload=function(){e.success(n(this.responseText))}):(t=new XMLHttpRequest,t.onreadystatechange=function(){4===this.readyState&&(200===this.status?e.success(n(this.responseText)):e.failed(this.status))});var r=e.method.toLowerCase();"get"===r&&e.url.searchParams.concat(e.data),t.open(e.method,e.url.href,e.async);for(var o in e.header)e.header.hasOwnProperty(o)&&t.setRequestHeader(o,e.header[o]);if("post,put,delete".indexOf(r)>=0){t.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded; charset=utf-8");var i=[];for(var a in e.data)e.data.hasOwnProperty(a)&&(getType(e.data[a])===_.a.c?i.push(mapArr(e.data[a],function(e){return a+"="+_.C(String(e))}).join("&")):i.push(a+"="+_.C(String(e.data[a]))));t.send(i.join("&"))}else t.send();if(_.F&&e.async===!1){var s=new XMLHttpRequest;s.onreadystatechange=function(){t.responseText&&s.abort()},s.open("get","/"+Math.random(),!1),s.send()}return t}function parseJson(e){try{return new Function("return "+e)()}catch(t){return new Function('return {status:{code: 405, msg:"'+e.replace(/\n/g,"")+'"}}')()}}function stringJson(e){var t=[];switch(getType(e)){case _.a.q:for(var n in e)e.hasOwnProperty(n)&&t.push('"'+n+'":'+stringJson(e[n]));return"{"+t.join(",")+"}";case _.a.c:case _.a.p:for(var r=0;r<e.length;r++)t.push(stringJson(e[r]));return"["+t.join(",")+"]";case _.a.o:return e;case _.a.g:return e;case _.a.k:return stringJson(e());case _.a.i:return e.getTime();case _.a.m:return stringJson.n.H(e.outerHTML);case _.a.t:return stringJson.n.H(e.textContent);case _.a.f:case _.a.e:return String(e);default:return stringJson.n.H(e)}}function storage(e,t,n){var r=n?localStorage:sessionStorage,o=parseJson(r.getItem("Q_storage_object")||"{}");return isUn(t)?!(t=o[e])&&isUn(n)&&(t=parseJson(localStorage.getItem("Q_storage_object")||"{}")[e]):isNull(t)?(t=o[e],delete o[e],r.setItem("Q_storage_object",stringJson(o))):(o[e]=t,r.setItem("Q_storage_object",stringJson(o))),t}function API(e){this.url=parseUrl(e),this.param={url:this.url.href,type:_.a.n},this.url.hostname!==location.hostname?this.type="jsonp":0===this.url.pathname.indexOf("/ck/")?this.type="xhr":(this.url.hostname="api.17k.com",this.type="jsonp")}var _={a:{b:"ARTWC_COM",c:"array",d:"string",e:"null",f:"undefined",g:"boolean",h:"comment",i:"date",j:"document",k:"function",l:"get",m:"html",n:"json",o:"number",p:"nodelist",q:"object",r:"post",s:function(e){return e=document.getElementsByTagName("script"),e[e.length-1].src.replace(/\/[^\/]+$/,"")}(),t:"text",u:"window",v:"xml",w:"body"},x:new Function,z:function(e,t){return t=this.A("script"),t.src=e,t},B:document.getElementsByTagName("head")[0],C:encodeURIComponent,D:decodeURIComponent,u:window,F:!window.addEventListener,G:Object.defineProperty,A:function(e){return document.createElement(e)}};_.F&&(String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")},Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++)e.apply(t||this,[this[n],n,this])},Array.prototype.filter=function(e,t){for(var n=[],r=0;r<this.length;r++)e.apply(t||this,[this[r],r,this])===!0&&n.push(this[r]);return n},Array.prototype.map=function(e,t){for(var n=[],r=0;r<this.length;r++)n.push(e.apply(t||this,[this[r],r,this]));return n},Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),window.Promise||(window.Promise=function(e){var t,n,r=function(e){t=e,i()};e(r,function(e){n=e,i()});var o=[],i=function(){var e,r;for(t!==undefined?(e="resolve",r=t):n!==undefined&&(e="reject",r=n);e&&r&&o[0];)o.shift()[e](r)};this.then=function(e,t){return o.push({resolve:e||new Function,reject:t||new Function}),i(),this}}),stringJson.n={I:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},J:function(e){return stringJson.n.I[e]||e},H:function(e){return'"'+String(e).replace(/[\x00-\x1f\\"]/g,stringJson.n.J)+'"'}},_.K=function(e,t){if(getType(e)===_.a.d)if(e.match(/^<[a-z\-]+>$/i))this.node=[_.A(e.substr(1,e.length-2))];else{t=t||document;var n=t.querySelectorAll(e);_.F?(this.node=[],forArr(n,function(e){this.node.push(e)},this)):this.node=[].slice.call(n)}else getType(e)===_.a.m?this.node=[e]:getType(e)===_.a.p?this.node=[].slice.call(e):(this.data=e,this.node=[e])},_.K.prototype={forEach:function(e){return getType(this.data)===_.a.q?forObj(this.data,e):getType(this.data)===_.a.c?forArr(this.data,e):forArr(this.node,e,this),this},map:function(e){return getType(this.data)===_.a.q?mapObj(this.data,e):getType(this.data)===_.a.c?mapArr(this.data,e):mapArr(this.node,e)},className:function(e,t){return forArr(this.node,function(n){t?n.className+=" "+e:n.className=e}),this},rmClass:function(e){return forArr(this.node,function(t){t.className=t.className.replace(e,"")}),this},style:function(e){var t=_.F?"setAttribute":"setProperty";return forArr(this.node,function(n){forObj(e,function(e,r){n.style[t](r,e,"")})}),this},rmStyle:function(e){var t=_.F?"removeAttribute":"removeProperty";switch(getType(e)){case _.a.c:forArr(this.node,function(n){forArr(e,function(e){n.style[t](e)})});break;case _.a.d:forArr(this.node,function(n){n.style[t](e)});break;default:forArr(this.node,function(e){e.style.cssText=""})}return this},add:function(e){return forArr(this.node,function(t){forObj(e,function(e,n){t.setAttribute(n,e)})}),this},del:function(e){return e=getType(e)===_.a.c?e:[e],forArr(this.node,function(t){forArr(e,function(e){t.removeAttribute(e)})}),this},get:function(e){switch(this.node.length){case 0:return"";case 1:return this.node[0].getAttribute(e)||this.node[0][e];default:return mapArr(this.node,function(t){return t.getAttribute(e)||t[e]})}},html:function(e,t){return isUn(e)?(e="",forArr(this.node,function(t){e+=t.innerHTML}),e):(e=String(e),forArr(this.node,function(n){t?n.innerHTML+=" "+e:n.innerHTML=e}),this)},append:function(e,t){function n(e,t,n){e.contains(n)?e.insertBefore(t,n):e.appendChild(t)}return t&&t.node&&(t=t.item()),getType(e)===_.a.p||getType(e)===_.a.c?forArr(this.node,function(r){forArr(e,function(e){n(r,e,t)})}):e&&getType(e.node)===_.a.c?forArr(this.node,function(r){forArr(e.node,function(e){n(r,e,t)})}):getType(e)===_.a.m?forArr(this.node,function(r){n(r,e,t)}):k("<div>").html(e).childs().forEach(function(e){forArr(this.node,function(r){n(r,e,t)})},this),this},appendTo:function(e,t){return getType(t)===_.a.m?forArr(this.node,function(n){e.insertBefore(n,t)}):forArr(this.node,function(t){e.appendChild(t)}),this},item:function(e){return e=e||0,e<0&&(e=this.node.length+e),this.node[e]},event:function(e,t){if(_.F){var n=function(e){e=window.event,e.target=e.srcElement,e.stopPropagation=function(){e.cancelBubble=!0},e.preventDefault=function(){e.returnValue=!1},t.call(e.srcElement,e)};"input"===e&&(e="propertychange",n=function(e){"value"===e.propertyName.toLowerCase()&&t.call(e.srcElement,e)}),forArr(this.node,function(t){t.attachEvent("on"+e,n)})}else forArr(this.node,function(n){n.addEventListener(e,t)});return this},stopEvent:function(e,t){return this.event(e,function(e){e.stopPropagation(),t&&t.call(this,e)})},onlyEvent:function(e,t){return this.event(e,function(e){e.stopPropagation(),e.preventDefault(),t&&t.call(this,e)})},remove:function(){return forArr(this.node,function(e){e.parentNode.removeChild(e)}),this},childs:function(e){var t=[];return forArr(this.node,function(n){forArr(n.childNodes,function(n){getType(n)===_.a.m&&(getType(e)===_.a.d?n.tagName===e.toUpperCase()&&t.push(n):t.push(n))})}),t},render:function(e,t){return this.randeDate=e,this.randeCallback=t||this.randeCallback||_.x,forArr(this.node,function(t){t.template||(t.template=t.innerHTML.replace(/[\r\n]+\s+/g,"")),t.innerHTML=_.L()(t.template,e),t.className=t.className.replace("QUI","QUIEND")}),this.randeCallback.call(this),this},updateRender:function(e,t){this.render(objComb(this.randeDate,e,!0),t)},appendRender:function(e,t){return forArr(this.node,function(t){for(var n,r=new _.K("<div>").html(_.L()(t.template,e)).childs(),o=0;n=r[o];o++)t.appendChild(n)}),t||this.randeCallback.call(this),this},cleanRender:function(){forArr(this.node,function(e){e.className=e.className.replace("QUIEND","QUI")})},stopRender:function(){forArr(this.node,function(e){e.className=e.className.replace("QUI","QUISTOP")})}},_.L=function(){function e(e){return 0!==e&&""!==e&&empty(e)}function t(e,t){return getType(t)===_.a.q?e.replace(s,function(e,n,r){var o;return 0===n.indexOf("!")?(o=t[n.substr(1)],isUn(o)?e:empty(o)?r:""):(o=t[n],isUn(o)?e:empty(o)?"":r)}):""}function n(e,t){if(t=t.trim(),t.indexOf(".")>0){t=t.split(".");for(var n=0;n<t.length&&(!isUn(e)&&!isNull(e));n++)e=e[t[n]]}else e=e[t];return e}function r(t,r){return getType(r)===_.a.q?t.replace(i,function(t,o){return t=o.split("||"),o=t[0].trim(),o=c.test(o)?new Function("return "+o.replace(c,function(e,t,o,i){return t+n(r,o)+i}))():n(r,o),e(o)?new Function("return "+t[1])()||"":o}):""}function o(e,n){var i=getType(n);return i===_.a.c||i===_.a.q?mapArr(i===_.a.c?n:[n],function(n){return r(t(e,n).replace(a,function(e,t,r){return o(r,n[t])}),n)}).join(""):""}var i=/{{(.+?)}}/g,a=/<!--for (\w+)-->(.+?)<!--endfor \1-->/g,s=/<!--if ([!\w]+)-->(.+?)<!--endif \1-->/g,c=/(\(["']?)([\w.]+)(["']?\))/g;return o};var k=function(e,t){if(getType(e)!==_.a.k)return new _.K(e,t);_.F?document.onreadystatechange=function(){"complete"===document.readyState&&(document.onreadystatechange=null,e(t))}:document.addEventListener("DOMContentLoaded",function(){e(t)})};k.author=config.author,k.version=config.version,k.objMerge=objMerge,k.objCombine=objComb,k.forEach=function(e,t){switch(getType(e)){case _.a.p:case _.a.c:forArr(e,t);break;case _.a.q:forObj(e,t);break;case _.a.d:forArr(e.split(""),t);break;default:return e}},k.map=function(e,t){switch(getType(e)){case _.a.c:return mapArr(e,t);case _.a.q:return mapObj(e,t);case _.a.d:return mapArr(e.split(""),t);default:return[]}},k.url=parseUrl,k.json={parse:function(){return parseJson}(),stringify:function(){return stringJson}()},k.getUrl=function(){var e=parseUrl(location.href).searchParams;return function(t){return e.get(t)||""}}(),k.getType=getType,k.empty=empty,k.request=xhr,k.get=function(e,t,n,r){var o={url:e,type:r||_.a.n};return getType(t)===_.a.k?(o.success=t,o.type=n||o.type):(o.data=t,o.success=n),xhr(o)},k.post=function(e,t,n,r){var o={url:e,method:_.a.r,type:r||_.a.n};return getType(t)===_.a.k?(o.success=t,o.type=r):(o.data=t,o.success=n),xhr(o)},k.jsonp=function(e,t,n,r){if(getType(t)===_.a.k&&(n=t,t={}),e=parseUrl(e,t),isUn(t.callback)){for(var o="Q_jsonp_",i=e.href,a=1,s=0;s<i.length;s++)a+=i[s].charCodeAt(0)*(s+1);o+=a,r!==undefined&&(o+=r),e.searchParams.set("callback",o)}return window[t.callback||o]=n||_.x,_.B.appendChild(_.z(e.href)),{abort:function(){window[t.callback]=_.x}}},k.apiPublicParam={appKey:2406394919},API.prototype={get:function(e){return e=k.objCombine(e||{},k.apiPublicParam),this.url.searchParams.concat(e),this.param.url=this.url.href,this},"delete":function(e){return this.param.method="delete",e=k.objCombine(e||{},k.apiPublicParam),this.url.searchParams.concat(e),this.param.url=this.url.href,this},post:function(e){return this.param.method=_.a.r,this.param.data=k.objCombine(e||{},k.apiPublicParam),this},put:function(e){return this.param.method="put",this.param.data=k.objCombine(e||{},k.apiPublicParam),this},send:function(e,t){var n=this,r=function(r){0===r.status.code?e&&e(r.data||[],r):t?t({status:r.status,code:r.status.code,msg:r.status.msg.replace(/[\w.]+:\s?/,"")}):console.error("api error: "+r.status.msg+";\ncode: "+r.status.code+";\nurl: "+n.url.href+";\nmethod: "+n.param.method)};"xhr"===this.type?xhr(objComb({success:r},this.param)):k.jsonp(this.url.href,r)}},k.api=function(e){return new API(e)},k.cookie=function(e,t,n,r,o){var i;return isUn(t)?(i=document.cookie.match(new RegExp(e+"=.*?(?=;|$)")),i?_.D(i[0].split("=")[1]):""):isNull(t)?void(document.cookie=e+"=null; expires="+new Date(-1).toUTCString()):(i=e+"="+_.C(t),isUn(o)||(i+="; domain="+o),isUn(r)||(i+="; path="+r),isUn(n)||("number"===getType(Number(n))&&(n=new Date((new Date).getTime()+1e3*n)),"date"===getType(n)&&(i+="; expires="+n.toUTCString())),document.cookie=i,t)},k.fullscreen=function(e,t,n){if(e=k(e).item(0)||document.documentElement,e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else{if(!e.webkitRequestFullscreen)return;e.webkitRequestFullScreen()}e.isFull=!0,window.onresize=function(){e.isFull?(e.isFull=!1,e.style.overflow="auto",t&&t(e)):(e.isFull=!0,e.style.removeProperty("overflow"),n&&n(e))}},k.formatNumber=function(e,t){return e=Number(e)||0,t?e.toLocaleString():e<1e4?e:e<9e5?Number((e/1e4).toFixed(1))+"万":e<9e6?Math.round(e/1e6)+"百万":e<9e7?Math.round(e/1e7)+"千万":Number((e/1e8).toFixed(1))+"亿"},k.chineseNumber=function(e,t){var n=["〇","一","二","三","四","五","六","七","八","九"];if(t)return mapArr(String(e).split(""),function(e){return n[e]}).join("");var r=["","十","百","千"],o=["","万","亿","兆"];return mapArr(String(e).split("").reverse(),function(e,t){return"0"===e?n[0]:n[e]+r[t%4]+(o[t/4]||"")}).reverse().join("").replace(new RegExp(n[0]+"+","g"),n[0]).replace(new RegExp(n[0]+"+$"),"")},k.save=function(e,t,n){return storage(e,t,n)},k.cache=function(e,t){return storage(e,t,1)},k.loadJs=loadJs,k.loadCss=loadCss,k.path=_.a.s,k.setCss=function(e){var t=_.A("style");t.appendChild(document.createTextNode("")),_.B.appendChild(t);for(var n in e)e.hasOwnProperty(n)&&t.sheet.insertRule(n+"{"+e[n]+"}",0)},k.isMail=function(e){return/^[\w\u4e00-\u9fa5]+((\.[\w\u4e00-\u9fa5]+)*)@([a-z0-9]+(-?[a-z0-9]+)*\.)+([a-z]{2,4})$/i.test(e)},k.isMobile=function(e){return/^1[3587][0-9]{9}$/.test(e)},k.getTextCount=function(e){return e.replace(/[\s\u3000]+/g,"").length},k.getByteLength=function(e){return e.replace(/[\u4e00-\u9fa5]/g,"**").length},k.trim=function(){},k.getaddr=function(e,t){if("::1"===e||0===e.indexOf("10.")||0===e.indexOf("192.168."))return void t({region:"*",region_id:"*",city:"内部网络",city_id:"*",ip:e});var n="Q_ip"+e.replace(/\./g,"")+(new Date).getTime();_.u[n]=function(e){e=parseJson(e),t("A00000"===e.code?e.address:null)},k.loadJs("//sip.1kmb.cn/getaddr?ip="+e+"&cb="+n)},k.scrollTo=function(e){var t=0,n=Math.max(document.documentElement.scrollTop,document.body.scrollTop);getType(e)===_.a.m?t=e.offsetTop:getType(e)===_.a.o&&(t=e);var r=0,o=t-n,i=function(){r<10&&(r++,window.scrollTo(0,n+o*Math.pow(r/10,2.2)),setTimeout(i,10))};i()},k.isLogin=function(){return!(!k.cookie("accessToken")&&!k.cookie("c_u"))},k.loginInfo=function(){var e=k.cookie("accessToken"),t={};if(e)forArr(e.split("&"),function(e){e=e.split("="),2===e.length&&(t[e[0]]=_.D(e[1]))});else{var n=k.cookie("c_u").split("&");t.nickname=function(e){var t=[];e=e.split("l");for(var n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}(n[0]),t.id=n[1]}return t},k.getUserInfo=function(e,t){t=t||_.x;var n=null,r={};return getType(e)===_.a.k?(t=e,e=k.loginInfo().id):isObj(e)&&(r=e,e=r.id,getType(e.success)===_.a.k&&(t=e.success),getType(e.failed)===_.a.k&&(n=e.failed)),!!e&&(k.api("/ck/user/"+e).get(r).send(function(e){t.call(k,e)},function(e){n?n(e):console.error("获取用户信息失败: "+e.msg)}),!0)},k.logout=function(e){k.cookie("c_u","",-1,"/","17k.com"),k.cookie("accessToken","",-1,"/","17k.com"),getType(e)===_.a.d?top.location.href=e:getType(e)===_.a.k?e():top.location.reload()},k.login=_.x,k.loginCallbacks=[],k.uuid=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var t=k.cookie("GUID");return t||(t=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e(),k.cookie("GUID",t,365,"/","17k.com")),t}(),k.isCPS=function(e){var t=parseUrl(location.href).searchParams,n=k.cookie("c_csc"),r=k.cookie("c_channel");return"url"===e&&(n=t.get("hmsr"),r=t.get("c_channel")),"referer"===e?1===storage("isCPS"):!(!n||!r||0!==r.indexOf("CPS-")||0!==n.indexOf(r))&&(!e||0!==e.indexOf("CPS-")||(r===e||!k.isLogin()&&t.get("c_channel")===e))},k.browser=function(e){var t=navigator.userAgent,n={webkit:t.indexOf("AppleWebKit")>-1,opera:t.indexOf("Presto")>-1,ie:t.indexOf("Trident")>-1,firefox:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")===-1,chrome:!!t.match(/((Chrome)|(CriOS))\/([\d.]+)(?!.+((UC)|(QQ))Browser)/),app:!!(window.chineseallread||window.webkit&&window.webkit.messageHandlers||parseUrl().searchParams.get("_versions")),mobile:!!t.match(/AppleWebKit.*Mobile|\(Android.*Mobile.+\).+Gecko.+Firefox|MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/i),pc:!this.mobile,android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),iphone:t.indexOf("iPhone")>-1,ipad:t.indexOf("iPad")>-1,wx:t.indexOf("MicroMessenger")>-1,weixin:this.wx,mqq:!!t.match(/QQBrowser\/([\d.]+)/),qq:this.mqq,uc:!!t.match(/UCBrowser\/([\d.]+)/),ua:t};return e?n[e]:n},k.platform="web",k.checkPlatform=function(e){return k.browser()[e]},k.require=function(name,alias){var url=name;return name.indexOf("/")===-1?url=_.a.s+"/mod/"+name+".js":(name=url.match(/([^\/]+)\.(js|jsrc|es6|mjs|jsx)\b/i),name=name?name[1]:"lastFunction"),alias&&(name=alias),xhr({url:url,type:"text",async:!1,success:function(data){var fn=eval(data);k[name]=function(){return fn.apply(k,arguments)}},failed:function(e){console.error(name+" require error,"+e)}}),k[name]},k.md5=function(e){return k.require("md5")(e)},k.alert=function(e){return k.require("alert")(e)},k.layout=function(e){return k.require("layout")(e)},k.date=function(e){return k.require("date")(e)},k.comment=function(e){return k.require("comment")(e)},k.help=function(){return k.require("help")()},k.pay=function(e){return k.require("pay")(e)},k.book=function(e){return k.require("book")(e)},k.imgCode=function(e,t,n,r){return k.require("imgCode")(e,t,n,r)},k.newUser=function(e,t){k.api("/ck/user/register/auto").post({autoVersion:2001}).send(e,t||console.error)},k.parseContent=function(e){return e.map(function(e){if("simple"===e.textType)return"<p>"+e.text.replace(/^[\s|\u3000]*/gm,"").replace(/[\r\n]/g,"</p><p>")+"</p>"}).join("")},k.loadAd=function(e,t,n){k.get(e,function(e){if(e=e?new Function("return "+e)():{},e.issue){var r=new Date(e.start_time.replace(/-/g,"/")).getTime()||0,o=new Date(e.end_time.replace(/-/g,"/")).getTime()||Infinity,i=(new Date).getTime();if(i>=r&&i<o){if(e.list.length){var a=e.list[Math.floor(Math.random()*e.list.length)];e.link=a.link,e.img=a.img}e.img.match(/.+\.(jpg|jpeg|gif|png)/i)&&t(e)}}else n&&n(e)},"text")},k.log=function(e){var t=k.log.y||0,n=k("<div>").html(e).style({background:"rgba(0,0,0,.7)",color:"white",position:"fixed",padding:"3px",font:"12px/1.2",overflow:"auto",top:t+"px",left:1,"max-width":"100%","min-width":"200px"}).appendTo(document.body);k.log.y=t+n.item(0).clientHeight+1},_.u[config.namespace]=_.u.QD=k}({author:"ZhangYongfeng",version:"2.5.20190326)",namespace:"k"});