    var loading={close:new Function},subscription=function(t,e){3===t?k.alert({text:e+"<br>您的余额不足",type:"failed",confirmText:"去充值",confirm:function(){location.href="//pay.17k.com/"}}):k.alert({text:e,type:"failed",confirmText:"订阅",confirm:function(){var e={bookId:Book.id,chapterId:Book.chapterid,useCoupon:1,platform:0};e.productTypeId=t?1:0,this.setType("loading"),k.api("/ck/user/consume").post(e).send(function(){k.alert({text:"订阅成功~"}),loadChapter()},function(t){k.alert({text:t.msg,type:"failed"})})},cancelText:"取消",cancel:function(){}})},autoSubscription=function(t,e){k.login(function(){k.api("/ck/book/auto-subscribe").post({platform:0,bookIds:Book.id,type:Number(t)}).send(function(){e&&k.alert("自动订阅设置"+(t?"成功":"已取消"))},function(t){k.alert({text:"设置失败:"+t.msg,type:"failed"})})})},loadChapter=function(){k(".free").html('<p style="text-align:center;"><img src="//static.17k.com/www/skin/all/loading1.gif"/></p>'),k.api("/ck/book/"+Book.id+"/chapter/"+Book.chapterid).get({subAllPrice:1}).send(function(t){if(0===t.userReadInfo.free)if(k.isLogin()){var e=function(t,e,n){var o={type:0,text:""};return n<=e?(o.type=0,o.text=n+"代金券"):n<=t+e?(o.type=0,o.text=n-e+"K币 + "+e+"代金券"):(o.type=3,o.text=n+"K币"),o},n=e(t.accountInfo.balance,t.accountInfo.totalBalance,t.price),o=e(t.accountInfo.balance,t.accountInfo.totalBalance,t.subAllPrice);k(".free").html('<div class="subscription"><p class="h2">请支持作者码字，支持正版！</p><p>亲爱的'+k.loginInfo().nickname+'，您的账户余额为 <span class="red">'+t.accountInfo.balance+"K币</span>，可用"+t.accountInfo.totalBalance+'代金券，现在去 <a href="//pay.17k.com/" target="_blank">充值</a>'+(t.isChoice.id?"":' 或者 <a href="//pay.17k.com/www/baoyue.html" target="_blank">开通包月</a>')+'</p><div class="btns"><a href="javascript:" onclick="subscription('+n.type+", '只订阅本章节共需要"+n.text+'\')" class="btn2">只订阅本章共需要 <span class="red">'+t.price+'K币</span></a><a href="javascript:" onclick="subscription('+(o.type||1)+",'订阅全部VIP章节共需要"+o.text+'\')" class="btn1">订阅全部VIP章节</span></a></div><p>温馨提示：'+(t.isChoice.id?"开通包月可享受订阅八折优惠。":"本书已加入包月书库，包月后可免费阅读。")+"</p></div>")}else k(".free").html('<a href="javascript:k.login(loadChapter);" class="login">本章需要登录才能继续阅读。</a>');else k(".free").remove(),k(".title").html(t.name),k(".content").html(k.parseContent(t.content)),1===t.isAutoSubscribe&&(window.autoOrder.checked=!0)},function(t){k.alert({text:t.msg,type:"failed"})})},setting={cookie:{name:"R_",domain:location.host,path:"/chapter",day:365,save:function(t,e){k.cookie(setting.cookie.name+t,e,setting.cookie.day,setting.cookie.path,setting.cookie.domain)},load:function(t){return k.cookie(setting.cookie.name+t)}},setScope:function(t){setting.cookie.path=t?"/chapter/"+Q.bookid:"/chapter"},setFontsize:function(t){var e=Number(setting.cookie.load("fontsize"))||1;e+=t,k(".Article").style({"font-size":e+"em"}),setting.cookie.save("fontsize",e)},setTheme:function(t){t=t||setting.cookie.load("theme"),k(".Context").className("Context "+t),setting.cookie.save("theme",t)},load:function(){setting.setFontsize(0),setting.setTheme()}};k("a.nextChapter").item()||k(".function .btns").append(k("<a>").className("nextChapter").add({href:"javascript:Book.nextChapter()"}).html("下一章"),k(".function .btns a").item(3)),function(){var t=k("<div>").className("Toolbar").appendTo(document.body),e=function(e,n,o){return k("<div>").className("icon").html('<img title="'+n+'" src="../reader_vip/'+e+'.png"/>').event("click",o).appendTo(t.item(0))};e("icon1","回到顶部",function(){k.scrollTo(140)}),e("icon2","阅读设置",function(){}).append(k("<div>").className("setting").html('<label><input type="checkbox" onchange="setting.setScope(this.checked)"/>只设置本书</label><div class="fontsize"><div class="h">字号</div><span onclick="setting.setFontsize(0.2)" title="放大" class="btn">A+</span><span onclick="setting.setFontsize(-0.2)" title="缩小" class="btn">A-</span></div><div class="theme"><div class="h">皮肤</div><span onclick="setting.setTheme(this.className)" title="默认黄色" class="Yellow"> </span><span onclick="setting.setTheme(this.className)" title="绿色" class="Green"> </span><span onclick="setting.setTheme(this.className)" title="蓝色" class="Blue"> </span><span onclick="setting.setTheme(this.className)" title="黑色" class="Black"> </span><span onclick="setting.setTheme(this.className)" title="清晨" class="Qinchen"> </span><span onclick="setting.setTheme(this.className)" title="海滩" class="Haitan"> </span><span onclick="setting.setTheme(this.className)" title="黄金" class="Huangjing"> </span><span onclick="setting.setTheme(this.className)" title="星球" class="Xinqiu"> </span><span onclick="setting.setTheme(this.className)" title="黑墙" class="Heiqiang"> </span></div>')),e("icon7","精减模式",function(){""===document.body.className?(document.body.className="ReadFull",this.className="icon now"):(document.body.className="",this.className="icon")}),e("icon8","手机阅读",function(){k.alert({text:'<p>扫描二维码，转到手机版继续阅读</p><img src="https://tool.oschina.net/action/qrcode/generate?data=//h5.17k.com/chapter/'+Book.id+"/"+Book.chapterid+".html&output=image%2Fgif&error=H&type=6&margin=20&size=4&"+(new Date).getTime()+'"/>',type:"none",confirmText:"关闭",confirm:function(){}})}),e("icon4","上一页",function(){var t=window.scrollY-document.documentElement.clientHeight+50;t<140&&(t=140),k.scrollTo(t)}),e("icon5","下一页",function(){var t=window.scrollY+document.documentElement.clientHeight-50,e=document.documentElement.scrollHeight-document.documentElement.clientHeight-550;t>e&&(t=e),k.scrollTo(t)}),e("icon6","自动滚动",function(){var t=this,e=function(){window.scrollBy(0,1),window.scrollY<document.documentElement.scrollHeight-document.documentElement.clientHeight-550?window.autoScrollFn=setTimeout(e,50):(t.className="icon",window.autoScrollFn=null)};window.autoScrollFn?(clearTimeout(window.autoScrollFn),window.autoScrollFn=null,this.className="icon"):(e(),this.className="icon now")})}(),loadChapter(),setting.load(),k.cookie("_read_vip_1d")||k.loadAd("/inc/fragment/pc/book/read_vip",function(t){k(".Context").style({background:"url("+t.img+") no-repeat center top fixed / auto"}).event("click",function(e){if(0===e.target.className.indexOf("Context")){var n=new Date;n.setHours(24),n.setMinutes(0),n.setSeconds(0),window.open(t.link)}})});
